# DNA Ledger â€” Thread Compilation (2026-01-15)

â­•ï¸ðŸ›‘ **Boundary Note**
- **Public-safe:** doctrine, architecture, invariants, non-proprietary math, high-level circuit spec
- **Protected:** deployment details, ops keys, secret parameters, proprietary pipeline implementation ("living-cipher" layer)

---

## 0) Scope

This thread produced two integrated tracks:

1) **Ethics-locked synthetic system architecture** (Ananke / Living Cipher split, probabilistic distance doctrine, dual geo-phase checks, verification harness)

2) **Teleport / state-mixer math + ZK proof architecture** (multi-step teleport chain in Halo2, corrected to be field-valid)

Plus: **static analysis hardening** guidance (mypy + ruff) suitable for DNA Ledger CI posture.

---

## 1) Locked Ethics + Provenance (Trust Layer)

### Ethics Anchor
- **Anchor (SHA-256):** `65b14d584f5a5fd070fe985eeb86e14cb3ce56a4fc41fd9e987f2259fe1f15c1`
- Embedded/verified across docs/tests/CI (reported: 27 locations)

### Hard Invariants (final phrasing)
- No human bodies as assets
- No likeness reconstruction
- No learning / memory / personalization loops
- No "engagement optimization" / escalation ladder
- No realism monetization tiers
- Revocable tokens
- Non-realistic guardrails at renderer boundary
- "Make it like me" resolves to **tokenized procedural variation**, **never identity / likeness / resemblance**

### Doctrinal add-on (new): Probabilistic Distance
> The system permits incidental human-like interpretations arising from random sampling, while enforcing sufficient probabilistic and structural distance to prevent convergence toward real human bodies or individuals.  
> Outputs may be perceptually close, but are probabilistically and structurally different.

See: `docs/ETHICS-PROBABILISTIC-DISTANCE.md`

---

## 2) Dual Geo-Phase Upgrade (Audit-only cosine buffer)

### What it is
- **GeoPhase A:** render-driving parameter projection (seed â†’ parameter vector)
- **GeoPhase B:** orthogonal projection (seed â†’ audit vector)
- **Cosine buffer:** audit-only non-alignment check on parameter vectors

Constraints:
- **Never runtime gating**
- **Never image-embedding-based**
- **Never anatomy-detection-based**

### Purpose
- Prove **non-collapse** / **non-convergence tendency** in parameter space
- Provide measurable spread for attestation reports
- Avoid introducing a hidden "filter loop" or resampling logic

See: `docs/GEO-PHASE.md`

---

## 3) Stronger `enhanced_F_k` (state mixer v2)

### Classification (clean)
`enhanced_F_k` is a:
> Nonlinear modular state mixer with entropy-gated nonlocal jumps (hybrid chaotic mixer)

### v2 Strengthening (today)
Conceptual upgrades:
- Deterministic **ancilla chain** (`seed + t â†’ u16`)
- Dual drift (primary `J(k)` + orthogonal `Jb(k)` mixer)
- Stateless teleport probability proxy `p_tp_state(k, Ja, Jb)` (no history)
- Teleport branch gating from ancilla (no reliance on global RNG)
- Optional OS CSPRNG integration for additional irreversibility:
  - `anc = deterministic_ancilla XOR os.urandom(2)`
  - still **routing-only**, never changes base law

Rule preserved:
- Entropy influences routing/jumps, not "learning."

See: `docs/STATE-MIXER-FK.md`

---

## 4) Halo2 Multi-Step Teleport Proof (Corrected Spec)

A full circuit sketch was tightened into a **Halo2-valid design**.

### Major corrections applied
- Removed undefined operations in circuit:
  - âŒ `abs`, `floor`, `sqrt`, floats, real arithmetic
- Removed probability-claims inside the circuit:
  - Use **selector bit** `b_i âˆˆ {0,1}` for teleport vs local
  - Circuit proves branch taken, not "randomness occurred"
- Redshift computation:
  - **lookup-only** (discretized table), not symbolic GR math in-circuit
- Chaining:
  - equality constraints; no permutation argument needed for linear path
- Option A chosen:
  - **one-scalar path** `k_i` and point `Q_i = k_iÂ·G`
  - drop redundant `P_i/Q_i` duplication

See: `docs/ZK-TELEPORT-OPTION-A.md`

---

## 5) Repo Split + Licensing (Open vs Proprietary)

### Open Source (Trust Layer)
- `ananke-core` (MIT): geometry generator, evolution, abstract renderer stubs, invariants/tests/CI
- `ananke-api-spec` (MIT): OpenAPI stub + audit surface
- `ananke-nft-schema` (CC0): seed-as-rights schema (regeneration rights, no media storage)

### Proprietary (Business Layer)
- `living-cipher` (Commercial EULA, ethics-bound): service wrapper + pipeline + revocation service + ops hardening  
(Billing paused / deactivated per note.)

---

## 6) Verification Harness (DNA Ledger style)

### Scripts/Targets
- `verify.sh` â€” structured multi-section verification
- `status.sh` â€” quick anchor/test/deps summary
- `Makefile` targets:
  - `make verify`, `make test`, `make ethics`, `make health`, `make attestation`, etc.

### CI Gates
- Ethics anchor integrity checks
- Forbidden concept scanning (ML, analytics, personalization, realism creep)
- Dependency audit (no ML frameworks, no analytics SDKs)
- Unit tests (determinism/no-memory/revocation/guards)

### Attestation
- `ATTESTATION.md`
- generated reports: `docs/ATTESTATION-{commit}.md`
- timestamped + commit-tagged

---

## 7) Static Analysis Hardening (mypy + ruff)

### mypy failures fixed conceptually by
- casting outputs of `json.load` / `argparse` away from `Any`
- narrowing types with runtime `isinstance` checks
- prefer `main() -> None` in CLIs (stdout + exit codes)

### ruff fixes
- `ruff check . --fix`
- `ruff format .`
- avoid `--unsafe-fixes`

### Recommended CI order
1) install deps (`pip install -e .`)
2) ruff check
3) mypy
4) pytest invariants

---

## 8) What to add to DNA Ledger repo (concrete artifacts)

Add docs:
- `docs/THREAD-2026-01-15.md` (this file)
- `docs/ETHICS-PROBABILISTIC-DISTANCE.md`
- `docs/ZK-TELEPORT-OPTION-A.md`
- `docs/GEO-PHASE.md`
- `docs/STATE-MIXER-FK.md`

---

## 9) Immediate TODOs (next commits)
1) Add docs listed above to DNA Ledger
2) Add glossary entry:
   - "Procedural personalization" â‰  "likeness personalization"
3) Add "Why no runtime cosine gating" paragraph (prevents stealth optimization loops)
4) Add Halo2 Option A spec as a work plan with TODO checklist (tables/lookup/gates)

See: `docs/ENGINEERING-TODO-2026-01-15.md`
